<div class="page-header">
  <h1>JWT Encoder</h1>
</div>

<p>
  All data and functionality here, are thanks to <strong><a href="https://github.com/garyf/json_web_token" target="_blank">this gem</a></strong>.
  <br><br>
</p>

<%= form_tag json_web_token_tools_url do %>
    <div class="row">
      <div class="col-xs-12 col-md-6">
        <div class="form-group">
          <label for="initial_text">Text to encode / decode</label>
          <%= text_area_tag :initial_text, @initial_text, :rows => 10, :class => 'form-control' %>
        </div>

        <div class="form-group">
          <label for="key">Key</label>
          <%= text_area_tag :key, @key, :rows => 3, :class => 'form-control' %>
        </div>

        <div class="form-group">
          <%= label_tag :algorithm, 'Select algorithm' %>
          <%= select_tag :algorithm, options_for_select([ ['None', 'none'],
                                                          [ 'HMAC using SHA-256', 'HS256' ],
                                                          [ 'HMAC using SHA-384', 'HS384' ],
                                                          [ 'HMAC using SHA-512', 'HS512' ],
                                                          [ 'RSASSA-PKCS-v1_5 using SHA-256', 'RS256' ],
                                                          [ 'RSASSA-PKCS-v1_5 using SHA-384', 'RS384' ],
                                                          [ 'RSASSA-PKCS-v1_5 using SHA-512', 'RS512' ],
                                                          [ 'ECDSA using P-256 and SHA-256', 'ES256' ],
                                                          [ 'ECDSA using P-384 and SHA-384', 'ES384' ],
                                                          [ 'ECDSA using P-521 and SHA-512', 'ES512' ]], params[:type]), :class => 'form-control' %>
        </div>

        <div class="form-group">
          <%= radio_button_tag :option, 'sign', (!params[:option].present? || params[:option] == 'sign') %>
          <%= label_tag :option_sign, "Sign" %>
          <%= radio_button_tag :option, 'verify', (params[:option] == 'verify') %>
          <%= label_tag :option_verify, 'Verify' %>
        </div>

        <div class="form-group">
          <%= submit_tag 'Refresh', :class => 'btn btn-primary' %>
        </div>
      </div>

      <div class="col-xs-12 col-md-6">
        <div class="form-group">
          <label for="final_text">Text after process</label>
          <%= text_area_tag :final_text, @final_text, :rows => 10, :class => 'form-control' %>
        </div>
      </div>
    </div>
<% end %>